# Maicraft插件配置模板

[llm]
model = "gpt-4o"
temperature = 0.2
api_key = "your-api-key"  # 可选，如果不设置将使用环境变量
base_url = "https://api.openai.com/v1"  # 可选，用于自定义API端点
max_tokens = 1024

[llm_fast]
model = "gpt-4o-mini"
temperature = 0.2
api_key = "your-api-key"  # 可选，如果不设置将使用环境变量
base_url = "https://api.openai.com/v1"  # 可选，用于自定义API端点
max_tokens = 1024

[agent_mode]
mode = "mai_agent"

[agent]
enabled = true
session_id = "maicraft_default"
max_steps = 50
tick_seconds = 8.0
report_each_step = true

[langchain]
max_token_limit = 4000
verbose = true
early_stopping_method = "generate"
handle_parsing_errors = true

# 错误检测配置
[error_detection]
# 错误检测模式：
# - "full_json": 返回完整JSON给LLM，让LLM自己判断错误（推荐）
# - "custom_keys": 使用自定义key检测错误
mode = "full_json"

# 当mode为"custom_keys"时，以下配置生效：

# 错误检测字段映射：字段名 -> 错误值
[error_detection.error_keys]
success = false
ok = false
error = true
failed = true
status = "failed"
result = "error"

# 错误消息字段列表（按优先级排序）
error_message_keys = [
  "error_message",
  "error",
  "message",
  "reason",
  "description",
]

# 错误代码字段列表（按优先级排序）
error_code_keys = ["error_code", "code", "status_code", "error_type"]

# 配置示例：

# 示例1：使用full_json模式（默认，推荐）
# [error_detection]
# mode = "full_json"

# 示例2：使用custom_keys模式，适配特定MCP服务器
# [error_detection]
# mode = "custom_keys"
# [error_detection.error_keys]
# status = "failed"
# result = "error"
# error_message_keys = ["message", "reason"]
# error_code_keys = ["code"]

# 示例3：适配标准REST API错误格式
# [error_detection]
# mode = "custom_keys"
# [error_detection.error_keys]
# success = false
# ok = false
# error_message_keys = ["error_message", "message"]
# error_code_keys = ["error_code", "code"]
