# Amaidesu é…ç½®æ–‡ä»¶
#
# ğŸ“ é…ç½®å±‚æ¬¡è¯´æ˜
# ================================
# æ­¤é…ç½®æ–‡ä»¶æ˜¯ç”¨æˆ·ä¸»é…ç½®ï¼ŒåŒ…å«ï¼š
# 1. å…¨å±€é…ç½®ï¼ˆLLMã€MaiCoreè¿æ¥ç­‰ï¼‰
# 2. Providerå¯ç”¨åˆ—è¡¨
# 3. å¸¸ç”¨å‚æ•°è¦†ç›–ï¼ˆå¯é€‰ï¼‰
#
# å„Providerçš„è¯¦ç»†é…ç½®åœ¨å„è‡ªçš„ config-defaults.toml ä¸­ï¼š
# - src/layers/*/providers/*/config-defaults.toml

# ========== å…¨å±€LLMé…ç½® ==========

# æ ‡å‡† LLM é…ç½®ï¼ˆç”¨äºé«˜è´¨é‡ä»»åŠ¡ï¼‰
[llm]
backend = "openai"              # openai | ollama | anthropic
model = "Pro/deepseek-ai/DeepSeek-V3.2"
temperature = 0.2
api_key = "your-api-key"                    # å¯é€‰ï¼Œå¦‚æœä¸è®¾ç½®å°†ä½¿ç”¨ç¯å¢ƒå˜é‡
base_url = "https://api.siliconflow.cn/v1/" # å¯é€‰ï¼Œç”¨äºè‡ªå®šä¹‰APIç«¯ç‚¹
max_tokens = 1024
max_retries = 3                 # å¯é€‰ï¼Œé»˜è®¤ 3
retry_delay = 1.0               # å¯é€‰ï¼Œé»˜è®¤ 1.0

# å¿«é€Ÿ LLM é…ç½®ï¼ˆç”¨äºä½å»¶è¿Ÿä»»åŠ¡ï¼Œå¦‚ Avatar è¡¨æƒ…åˆ†æï¼‰
[llm_fast]
backend = "openai"
model = "Qwen/Qwen3-8B"
temperature = 0.2
api_key = "your-api-key"
base_url = "https://api.siliconflow.cn/v1/"
max_tokens = 1024

# è§†è§‰è¯­è¨€æ¨¡å‹é…ç½®ï¼ˆç”¨äºå›¾åƒç†è§£ä»»åŠ¡ï¼‰
[vlm]
backend = "openai"
model = "zai-org/GLM-4.6V"
temperature = 0.3
api_key = "your-api-key"
base_url = "https://api.siliconflow.cn/v1/"
max_tokens = 1024

# æœ¬åœ° Ollama é…ç½®ï¼ˆå¯é€‰ï¼‰
[llm_local]
backend = "ollama"
model = "llama3"
api_base = "http://localhost:11434/v1"
api_key = "sk-dummy"            # Ollama ä¸éœ€è¦çœŸå® API key

# ========== Amaidesuæ ¸å¿ƒé…ç½® ==========

[general]
# Amaidesu åœ¨ MaiCore ä¸­æ³¨å†Œçš„å¹³å°æ ‡è¯†ç¬¦
platform_id = "amaidesu"

[maicore]
# MaiCore WebSocket æœåŠ¡å™¨åœ°å€
host = "127.0.0.1"
# MaiCore WebSocket æœåŠ¡å™¨ç«¯å£
port = 8000
# token = "your_maicore_token_if_needed" # å¦‚æœ MaiCore éœ€è¦è®¤è¯ï¼Œå–æ¶ˆæ³¨é‡Šå¹¶è®¾ç½®

# è®¯é£ RTASR å®æ—¶è¯†åˆ«å‡­æ®ï¼ˆå¯é€‰ï¼‰
[spark_rtasr]
app_id = ""
access_key_id = ""
access_key_secret = ""
# å¯é€‰ï¼šè‡ªå®šä¹‰ websocket URLï¼ˆé»˜è®¤å®˜æ–¹åœ°å€ï¼‰
# ws_url = "wss://office-api-ast-dx.iflyaisol.com/ast/communicate/v1"

# HTTPå›è°ƒæœåŠ¡å™¨é…ç½®
[http_server]
enable = true
host = "127.0.0.1"
port = 8080
callback_path = "/maicore_callback"

# ä¸Šä¸‹æ–‡ç®¡ç†å™¨é…ç½®
[context_manager]
enabled = true

[context_manager.formatting]
separator = "\n"           # ä¸Šä¸‹æ–‡é¡¹ä¹‹é—´çš„åˆ†éš”ç¬¦
add_provider_title = false # æ˜¯å¦åœ¨ä¸Šä¸‹æ–‡å‰æ·»åŠ æä¾›è€…åç§°
title_separator = ": "     # å¦‚æœæ·»åŠ æä¾›è€…åç§°ï¼Œä½¿ç”¨çš„åˆ†éš”ç¬¦

[context_manager.limits]
default_max_length = 1000  # é»˜è®¤ä¸Šä¸‹æ–‡æœ€å¤§é•¿åº¦
default_priority = 100     # é»˜è®¤ä¼˜å…ˆçº§å€¼

# ========== ç®¡é“é…ç½® ==========

[pipelines]
# TextPipeline ç¤ºä¾‹ï¼šé™æµ
# [pipelines.rate_limit]
# priority = 100
# global_rate_limit = 100  # å…¨å±€æ¯åˆ†é’Ÿæœ€å¤§æ¶ˆæ¯æ•°
# user_rate_limit = 10     # æ¯ä¸ªç”¨æˆ·æ¯åˆ†é’Ÿæœ€å¤§æ¶ˆæ¯æ•°
# window_size = 60         # æ»‘åŠ¨çª—å£å¤§å°ï¼ˆç§’ï¼‰

# MessagePipeline ç¤ºä¾‹ï¼šå‘½ä»¤å¤„ç†å™¨
[pipelines.command_processor]
priority = 50
# å¯ä»¥åœ¨æ­¤è¦†ç›– command_map
# command_map = { vts_trigger_hotkey = { service = "vts_control", method = "trigger_hotkey" } }

# ========== Provideré…ç½® ==========

# === è¾“å…¥Providerï¼ˆLayer 1: Perceptionï¼‰ ===
[providers.input]
enabled = true
# å¯ç”¨çš„è¾“å…¥Provideråˆ—è¡¨
enabled_inputs = [
    # æ§åˆ¶å°è¾“å…¥ï¼ˆå¼€å‘æµ‹è¯•ç”¨ï¼‰
    # "console_input",

    # Bç«™å¼¹å¹•è¾“å…¥
    # "bili_danmaku",           # æ™®é€šBç«™å¼¹å¹•
    # "bili_danmaku_official",  # Bç«™å®˜æ–¹å¼¹å¹•ï¼ˆä¸è¦å’Œbili_danmakuåŒæ—¶å¯ç”¨ï¼‰
    # "bili_danmaku_selenium",  # Bç«™å¼¹å¹•-Seleniumç‰ˆ

    # å…¶ä»–è¾“å…¥
    # "mock_danmaku",           # æ¨¡æ‹Ÿå¼¹å¹•
    # "read_pingmu",            # è¯»å±æœ¨
]

# å¸¸ç”¨å‚æ•°è¦†ç›–ï¼ˆå¯é€‰ï¼‰
# [providers.input.overrides]
# bili_danmaku.room_id = "123456"

# === è¾“å‡ºProviderï¼ˆLayer 5: Renderingï¼‰ ===
[providers.output]
enabled = true
concurrent_rendering = true
error_handling = "continue"  # continueï¼ˆç»§ç»­ï¼‰ | stopï¼ˆåœæ­¢ï¼‰ | dropï¼ˆä¸¢å¼ƒï¼‰

# å¯ç”¨çš„è¾“å‡ºProvideråˆ—è¡¨
enabled_outputs = [
    # åŸºç¡€è¾“å‡ºï¼ˆæ¨èå¯ç”¨ï¼‰
    "subtitle",     # å­—å¹•
    "vts",          # VTSæ§åˆ¶

    # TTSè¾“å‡ºï¼ˆé€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªï¼‰
    # "tts",         # Edge TTS
    # "omni_tts",    # Omni TTS (GPT-SoVITS)

    # å…¶ä»–è¾“å‡º
    # "sticker",     # è¡¨æƒ…è´´çº¸
]

# ExpressionGeneratoré…ç½®
[providers.output.expression_generator]
default_tts_enabled = true
default_subtitle_enabled = true
default_expressions_enabled = true
default_hotkeys_enabled = true

# å¸¸ç”¨å‚æ•°è¦†ç›–ï¼ˆå¯é€‰ï¼‰
# [providers.output.overrides]
# subtitle.font_size = 32
# subtitle.window_width = 1000
# vts.vts_host = "192.168.1.100"
# tts.voice = "zh-CN-YunxiNeural"

# === å†³ç­–Providerï¼ˆLayer 3: Decisionï¼‰ ===
[providers.decision]
enabled = true
# å½“å‰ä½¿ç”¨çš„å†³ç­–Provider
active_provider = "maicore"
# æ”¯æŒçš„å†³ç­–Provideråˆ—è¡¨
available_providers = [
    "maicore",        # MaiCoreå†³ç­–ï¼ˆé»˜è®¤ï¼‰
    "rule_engine",    # è§„åˆ™å¼•æ“
    "local_llm",      # æœ¬åœ°LLM
]

# å¸¸ç”¨å‚æ•°è¦†ç›–ï¼ˆå¯é€‰ï¼‰
# [providers.decision.overrides]
# maicore.host = "192.168.1.100"
# local_llm.system_prompt = "ä½ æ˜¯ä¸€ä¸ªå‹å–„çš„AIåŠ©æ‰‹"
